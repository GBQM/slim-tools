services:
  app:
    class: Neochic\SlimTools\Core\App
    arguments:
      - %core%
      - @slim
      - %routers%
  console_base:
    class: Neochic\SlimTools\Core\Console
    arguments:
      - %database.migrations%
      - @entity_manager
  console:
    parent: console_base
  slim:
    class: Slim\Slim
  session:
    class: Neochic\SlimTools\Misc\Session
  jsonResponse:
    class: Neochic\SlimTools\Misc\JsonResponse
  validator:
    class: Neochic\SlimTools\Core\Validator
  entity_manager.factory:
    class: Neochic\SlimTools\Factory\EntityManagerFactory
  entity_manager:
    class: Doctrine\ORM\EntityManager
    factory: [@entity_manager.factory, createEntityManager]
    arguments:
      - %database.mysql%
      - %doctrine%
  view.json:
    class: Neochic\SlimTools\View\Json
    arguments:
      - @serializer
  view.media:
    class: Neochic\SlimTools\View\Media
  router:
    abstract: true
    arguments:
      - @app
      - @slim
  router.rest:
    class: Neochic\SlimTools\Router\RestRouter
    parent: router
    arguments:
      - @view.json
  router.media:
    class: Neochic\SlimTools\Router\MediaRouter
    parent: router
    arguments:
      - @view.media
  controller:
    abstract: true
    arguments:
      - @slim
      - @entity_manager
  serializer.IdenticalPropertyNamingStrategy:
    class: JMS\Serializer\Naming\IdenticalPropertyNamingStrategy
  serializer.SerializedNameAnnotationStrategy:
    class: JMS\Serializer\Naming\SerializedNameAnnotationStrategy
    arguments:
      - @serializer.IdenticalPropertyNamingStrategy
  serializer.builder.factory:
    class: JMS\Serializer\SerializerBuilder
  serializer.builder:
    class: JMS\Serializer\SerializerBuilder
    factory: [@serializer.builder.factory, create]
  serializer.factory:
    class: Neochic\SlimTools\Factory\SerializerFactory
  serializer:
    class: JMS\Serializer\Serializer
    factory: [@serializer.factory, createSerializer]
    arguments:
      - %serializer%
      - @serializer.builder
      - @serializer.SerializedNameAnnotationStrategy